"use strict";(self.webpackChunkxiaozhi=self.webpackChunkxiaozhi||[]).push([[359],{3410:function(e,a,t){t.d(a,{A:function(){return i}});var s={props:{title:{type:String,default:"新增参数"},visible:{type:Boolean,default:!1},form:{type:Object,default:()=>({id:null,paramCode:"",paramValue:"",valueType:"string",remark:""})}},data(){return{dialogKey:Date.now(),saving:!1,valueTypeOptions:[{value:"string",label:"字符串(string)"},{value:"number",label:"数字(number)"},{value:"boolean",label:"布尔值(boolean)"},{value:"array",label:"数组(array)"},{value:"json",label:"JSON对象(json)"}],rules:{paramCode:[{required:!0,message:"请输入参数编码",trigger:"blur"}],paramValue:[{required:!0,message:"请输入参数值",trigger:"blur"}],valueType:[{required:!0,message:"请选择值类型",trigger:"change"}]}}},methods:{submit(){this.$refs.form.validate((e=>{e&&(this.saving=!0,this.$emit("submit",{form:this.form,done:()=>{this.saving=!1}}),setTimeout((()=>{this.saving=!1}),3e3))}))},cancel(){this.saving=!1,this.$emit("cancel")}},watch:{visible(e){e&&(this.dialogKey=Date.now())}}},i=(0,t(1656).A)(s,(function(){var e=this,a=e._self._c;return a("el-dialog",{key:e.dialogKey,staticClass:"param-dialog-wrapper",attrs:{title:e.title,visible:e.visible,width:"520px","append-to-body":!0,"close-on-click-modal":!1,"custom-class":"custom-param-dialog","show-close":!1},on:{"update:visible":function(a){e.visible=a}}},[a("div",{staticClass:"dialog-container"},[a("div",{staticClass:"dialog-header"},[a("h2",{staticClass:"dialog-title"},[e._v(e._s(e.title))]),a("button",{staticClass:"custom-close-btn",on:{click:e.cancel}},[a("svg",{attrs:{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M13 1L1 13M1 1L13 13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}})])])]),a("el-form",{ref:"form",staticClass:"param-form",attrs:{model:e.form,rules:e.rules,"label-width":"110px","label-position":"left"}},[a("el-form-item",{staticClass:"form-item",attrs:{label:"参数编码",prop:"paramCode"}},[a("el-input",{staticClass:"custom-input",attrs:{placeholder:"请输入参数编码"},model:{value:e.form.paramCode,callback:function(a){e.$set(e.form,"paramCode",a)},expression:"form.paramCode"}})],1),a("el-form-item",{staticClass:"form-item",attrs:{label:"参数值",prop:"paramValue"}},[a("el-input",{staticClass:"custom-input",attrs:{placeholder:"请输入参数值"},model:{value:e.form.paramValue,callback:function(a){e.$set(e.form,"paramValue",a)},expression:"form.paramValue"}})],1),a("el-form-item",{staticClass:"form-item",attrs:{label:"值类型",prop:"valueType"}},[a("el-select",{staticClass:"custom-select",attrs:{placeholder:"请选择值类型"},model:{value:e.form.valueType,callback:function(a){e.$set(e.form,"valueType",a)},expression:"form.valueType"}},e._l(e.valueTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{staticClass:"form-item remark-item",attrs:{label:"备注",prop:"remark"}},[a("el-input",{staticClass:"custom-textarea",attrs:{type:"textarea",placeholder:"请输入备注",rows:3},model:{value:e.form.remark,callback:function(a){e.$set(e.form,"remark",a)},expression:"form.remark"}})],1)],1),a("div",{staticClass:"dialog-footer"},[a("el-button",{staticClass:"save-btn",attrs:{type:"primary",loading:e.saving,disabled:e.saving},on:{click:e.submit}},[e._v(" 保存 ")]),a("el-button",{staticClass:"cancel-btn",on:{click:e.cancel}},[e._v(" 取消 ")])],1)],1)])}),[],!1,null,"47e7f12d",null).exports},9145:function(e,a,t){t.d(a,{A:function(){return i}});var s={name:"VersionFooter",computed:{...(0,t(5353).aH)({version:e=>e.pubConfig.version,name:e=>e.pubConfig.name,beianIcpNum:e=>e.pubConfig.beianIcpNum,beianGaNum:e=>e.pubConfig.beianGaNum,year:e=>e.pubConfig.year})},mounted(){this.$store.dispatch("fetchPubConfig")}},i=(0,t(1656).A)(s,(function(){var e=this,a=e._self._c;return a("div",{staticClass:"copyright"},[a("div",{staticClass:"footer-content"},[a("span",[e._v(e._s(e.year)+" "+e._s(e.name)+" "+e._s(e.version))]),"null"!==e.beianGaNum?["null"!==e.beianIcpNum||e.name?a("span",[e._v("|")]):e._e(),a("a",{staticClass:"beian-link",attrs:{href:"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode="+e.beianGaNum,target:"_blank",rel:"noopener"}},[a("img",{staticClass:"beian-icon",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAMAAABhEH5lAAACXlBMVEUAAADax4rGxqP556zmsVD/6KXu5JvwvFPglEFnY3nnpEjosU1+XFTmuVfu13Hrv1jpsFa1k3mne2HlvnPdqmPqz3fu3YrJoWv04J/mz5z246aSi3i2p2/0zGj82WDrtFjar1O7klO4dkfimUJcWnbho0rgr1vntFfmvFflvGOZdFKXZkOUemnmv2XkuWWVe2ziqlXnt1Tr0HDpwl6ObmCkbEKqhVyOc2jdoVHmuljfrmDq0nPapWDUnErqy3XjtWXesXLrzHjz34rqzYfmw3fy4YrqyYDevW/dzoTIhkndsXLRsIneuHjlyIzQroTjuXjlyYfktWvw2prhvoHTmGfx45j3773TuYT/25LdijyKf321oXU+Nm3cumXfuWLtwlzpwVz40FvpvlvqvFfouFXjrlHipEjcmEfknEXPbzfbZyzZQR/YMBrWKBrhJhLdHxDTGg5HV4xBT4YYKYaWk4SDgYIWIYBybH0qLn1KS3tlZHpNS3WGfHIcHXEwLHAnF28rKW07NGuzn2pNQ2ruzWnDrGnuy2jryGjAnGgoH2j1x2RCNGPcrmIsEGGQdl/pu17YtV7FoV3muVxoRVzWqFvSmVp2SVbyw1XbkVTuvFPfo1PgmVPpt1LcnFLWkVLlp1F7W1HpsU92QE5oMUtFAUrpqUjnjUFOAEHUgz+DUj14FzvbczieMTdhATfodjXWcDXcbjXVcTS/Xi/hay7WXS3cWS3vYyvaVSrUVymnJSjXSyeKDSbNSiWfHCPMTyLFQiHkSR/lPxvVLRrPLBnUJRfUHhbaJxXVGxTZJxPNFhBdOhm/AAAAWXRSTlMABQIU/hIJ/v79/Pj29PPx4cC6s7CNfmxZWRv+/v7+/v7+/v78/Pr6+fPz8vHq6ujl5eTj4ODe2NTQzMW6ubKsnJeQkJCJiIOBgX9ubGpoW1lMREM0JR8dDgvYx1gAAAE7SURBVBjTYgADJmZJQUFJZiYGOGD2EzLV1jIT8paCibCJ86zctGPD1D4ecUaICKuPyYLMYznZOfNqzP0jwEJBOt1KB4/mHjqZ3dGsHwxW5M4Zk5l/PPdIQcGMShUPVqBlgQLlMSvyDq+P3HVidjWnkQQTA5MXV1SFYtb+jZGrl02si2J3Y2JgFMmILl68efueLVvXLSqLXirCCBgDow1HT+GS/AP7srblLS+K5bIHCjmodpXUr929d+eaVb3SsuouQCHhufPjShsbJk/rrK2KW8hiBxRyVkvnkI9tnaDQJDNFOU1DDOjRMEfe9Mjpiewz5RIzZmmKMoPcKqGbkJqSkBSfnDqpXS+ACeRpJ76W/uSUpDlpLPFtfK5soLAKFbU05Odm4eblN7YWk4KEGWOIp62FgYCVsG84SAAAL7BaooX965sAAAAASUVORK5CYII=",alt:"备案图标"}}),a("span",{staticClass:"beian-text"},[e._v(e._s(e.beianGaNum))])])]:e._e(),"null"!==e.beianIcpNum?[e.name?a("span",[e._v("|")]):e._e(),a("a",{staticClass:"beian-link",attrs:{href:"https://beian.miit.gov.cn/",target:"_blank",rel:"noopener"}},[a("span",{staticClass:"beian-text"},[e._v(e._s(e.beianIcpNum))])])]:e._e()],2)])}),[],!1,null,"1bdde94e",null).exports},9300:function(e,a,t){t.r(a),t.d(a,{default:function(){return c}});var s=t(9237),i=t(7853),l=t(3410),r=t(9145),n={components:{HeaderBar:i.A,ParamDialog:l.A,VersionFooter:r.A},data(){return{searchCode:"",paramsList:[],currentPage:1,loading:!1,pageSize:10,pageSizeOptions:[10,20,50,100],total:0,dialogVisible:!1,dialogTitle:"新增参数",isAllSelected:!1,sensitive_keys:["api_key","personal_access_token","access_token","token","secret","access_key_secret","secret_key"],paramForm:{id:null,paramCode:"",paramValue:"",remark:""}}},created(){this.fetchParams()},computed:{pageCount(){return Math.ceil(this.total/this.pageSize)},visiblePages(){const e=[];let a=Math.max(1,this.currentPage-1),t=Math.min(this.pageCount,a+3-1);t-a+1<3&&(a=Math.max(1,t-3+1));for(let s=a;s<=t;s++)e.push(s);return e}},methods:{handlePageSizeChange(e){this.pageSize=e,this.currentPage=1,this.fetchParams()},fetchParams(){this.loading=!0,s.A.admin.getParamsList({page:this.currentPage,limit:this.pageSize,paramCode:this.searchCode},(({data:e})=>{this.loading=!1,0===e.code?(this.paramsList=e.data.list.map((e=>({...e,selected:!1,showValue:!1}))),this.total=e.data.total):this.$message.error({message:e.msg||"获取参数列表失败",showClose:!0})}))},handleSearch(){this.currentPage=1,this.fetchParams()},handleSelectAll(){this.isAllSelected=!this.isAllSelected,this.paramsList.forEach((e=>{e.selected=this.isAllSelected}))},showAddDialog(){this.dialogTitle="新增参数",this.paramForm={id:null,paramCode:"",paramValue:"",remark:""},this.dialogVisible=!0},editParam(e){this.dialogTitle="编辑参数",this.paramForm={...e},this.dialogVisible=!0},handleSubmit({form:e,done:a}){e.id?s.A.admin.updateParam(e,(({data:e})=>{0===e.code&&(this.$message.success({message:"修改成功",showClose:!0}),this.dialogVisible=!1,this.fetchParams()),a&&a()})):s.A.admin.addParam(e,(({data:e})=>{0===e.code&&(this.$message.success({message:"新增成功",showClose:!0}),this.dialogVisible=!1,this.fetchParams()),a&&a()}))},deleteSelectedParams(){const e=this.paramsList.filter((e=>e.selected));0!==e.length?this.deleteParam(e):this.$message.warning({message:"请先选择需要删除的参数",showClose:!0})},deleteParam(e){const a=Array.isArray(e)?e:[e];if(Array.isArray(e)&&0===e.length)return void this.$message.warning({message:"请先选择需要删除的参数",showClose:!0});const t=a.length;this.$confirm(`确定要删除选中的${t}个参数吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",distinguishCancelAndClose:!0}).then((()=>{const e=a.map((e=>e.id));e.some((e=>isNaN(e)))?this.$message.error({message:"存在无效的参数ID",showClose:!0}):s.A.admin.deleteParam(e,(({data:e})=>{0===e.code?(this.$message.success({message:`成功删除${t}个参数`,showClose:!0}),this.fetchParams()):this.$message.error({message:e.msg||"删除失败，请重试",showClose:!0})}))})).catch((e=>{"cancel"===e?this.$message({type:"info",message:"已取消删除操作",duration:1e3}):this.$message({type:"info",message:"操作已关闭",duration:1e3})}))},headerCellClassName({columnIndex:e}){return 0===e?"custom-selection-header":""},goFirst(){this.currentPage=1,this.fetchParams()},goPrev(){this.currentPage>1&&(this.currentPage--,this.fetchParams())},goNext(){this.currentPage<this.pageCount&&(this.currentPage++,this.fetchParams())},goToPage(e){this.currentPage=e,this.fetchParams()},isSensitiveParam(e){return this.sensitive_keys.some((a=>e.toLowerCase().includes(a.toLowerCase())))},maskSensitiveValue(e){return e?e.length<=8?"****":e.substring(0,4)+"****"+e.substring(e.length-4):""},toggleSensitiveValue(e){this.$set(e,"showValue",!e.showValue)}}},o=(0,t(1656).A)(n,(function(){var e=this,a=e._self._c;return a("div",{staticClass:"welcome"},[a("HeaderBar"),a("div",{staticClass:"operation-bar"},[a("h2",{staticClass:"page-title"},[e._v("参数管理")]),a("div",{staticClass:"right-operations"},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入参数编码或备注查询",clearable:""},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchCode,callback:function(a){e.searchCode=a},expression:"searchCode"}}),a("el-button",{staticClass:"btn-search",on:{click:e.handleSearch}},[e._v("搜索")])],1)]),a("div",{staticClass:"main-wrapper"},[a("div",{staticClass:"content-panel"},[a("div",{staticClass:"content-area"},[a("el-card",{staticClass:"params-card",attrs:{shadow:"never"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"paramsTable",staticClass:"transparent-table",attrs:{data:e.paramsList,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.7)","header-cell-class-name":e.headerCellClassName}},[a("el-table-column",{attrs:{label:"选择",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox",{model:{value:t.row.selected,callback:function(a){e.$set(t.row,"selected",a)},expression:"scope.row.selected"}})]}}])}),a("el-table-column",{attrs:{label:"参数编码",prop:"paramCode",align:"center"}}),a("el-table-column",{attrs:{label:"参数值",prop:"paramValue",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isSensitiveParam(t.row.paramCode)?a("div",[t.row.showValue?a("span",[e._v(e._s(t.row.paramValue))]):a("span",[e._v(e._s(e.maskSensitiveValue(t.row.paramValue)))]),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.toggleSensitiveValue(t.row)}}},[e._v(" "+e._s(t.row.showValue?"隐藏":"查看")+" ")])],1):a("span",[e._v(e._s(t.row.paramValue))])]}}])}),a("el-table-column",{attrs:{label:"备注",prop:"remark",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.editParam(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.deleteParam(t.row)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"table_bottom"},[a("div",{staticClass:"ctrl_btn"},[a("el-button",{staticClass:"select-all-btn",attrs:{size:"mini",type:"primary"},on:{click:e.handleSelectAll}},[e._v(" "+e._s(e.isAllSelected?"取消全选":"全选")+" ")]),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:e.showAddDialog}},[e._v("新增")]),a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteSelectedParams}},[e._v("删除")])],1),a("div",{staticClass:"custom-pagination"},[a("el-select",{staticClass:"page-size-select",on:{change:e.handlePageSizeChange},model:{value:e.pageSize,callback:function(a){e.pageSize=a},expression:"pageSize"}},e._l(e.pageSizeOptions,(function(e){return a("el-option",{key:e,attrs:{label:`${e}条/页`,value:e}})})),1),a("button",{staticClass:"pagination-btn",attrs:{disabled:1===e.currentPage},on:{click:e.goFirst}},[e._v(" 首页 ")]),a("button",{staticClass:"pagination-btn",attrs:{disabled:1===e.currentPage},on:{click:e.goPrev}},[e._v(" 上一页 ")]),e._l(e.visiblePages,(function(t){return a("button",{key:t,staticClass:"pagination-btn",class:{active:t===e.currentPage},on:{click:function(a){return e.goToPage(t)}}},[e._v(" "+e._s(t)+" ")])})),a("button",{staticClass:"pagination-btn",attrs:{disabled:e.currentPage===e.pageCount},on:{click:e.goNext}},[e._v(" 下一页 ")]),a("span",{staticClass:"total-text"},[e._v("共"+e._s(e.total)+"条记录")])],2)])],1)],1)])]),a("param-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,form:e.paramForm},on:{"update:visible":function(a){e.dialogVisible=a},submit:e.handleSubmit,cancel:function(a){e.dialogVisible=!1}}}),a("el-footer",[a("version-footer")],1)],1)}),[],!1,null,"aa24cca4",null),c=o.exports}}]);